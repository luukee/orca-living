{% comment %}
  Section: Collection Value Props
  
  Displays a series of value propositions for a collection using metafield data.
  Each value prop consists of an image, title, and description in an alternating layout.
  
  Metafield Structure:
  - Namespace: custom.collection_value_props
  - Type: metaobject
  - Fields:
    - image: Image picker
    - title: Single line text
    - description: Multi line text
  
  Usage:
  1. Create metafield in Shopify Admin
  2. Add values to collection metafields
  3. Add this section to collection template
{% endcomment %}

<div class="page-width">
  {% comment %}
    Fetch value props from collection metafields
    Returns array of objects containing image, title, and description
  {% endcomment %}
  {% assign value_props = collection.metafields.custom.collection_value_props.value %}
  
  {% if value_props != blank %}
    <div class="value-props-grid">
      {% comment %}
        Loop through each value prop
        Even items will have image on right, odd items on left
      {% endcomment %}
      {% for prop in value_props %}
        <div class="value-prop-item">
          {% if prop.image != blank %}
            <div class="value-prop-image">
              {% comment %}
                Image rendering with:
                - Lazy loading for performance
                - 800px width for quality
                - Square aspect ratio (800x800)
                - Alt text from title for accessibility
              {% endcomment %}
              {{ prop.image | image_url: width: 800 | image_tag: 
                loading: 'lazy',
                alt: prop.title,
                width: 800,
                height: 800
              }}
            </div>
          {% endif %}
          
          <div class="value-prop-content">
            {% if prop.title != blank %}
              <h3 class="value-prop-title">{{ prop.title }}</h3>
            {% endif %}
            
            {% if prop.description != blank %}
              <div class="value-prop-description">{{ prop.description }}</div>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
</div>

{% schema %}
{
  "name": "Collection Value Props",
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "columns_desktop",
      "label": "Columns on desktop",
      "options": [
        {
          "value": "2",
          "label": "2 columns"
        },
        {
          "value": "3",
          "label": "3 columns"
        },
        {
          "value": "4",
          "label": "4 columns"
        }
      ],
      "default": "3"
    }
  ],
  "presets": [
    {
      "name": "Collection Value Props"
    }
  ]
}
{% endschema %}

{% comment %}
  Styles:
  - Grid layout with alternating image positions
  - Responsive design (stacks on mobile)
  - Uses Shopify's color system with CSS variables
  - Maintains square aspect ratio for images
{% endcomment %}
<style>
.value-props-grid {
  display: grid;
  gap: 4rem;
  margin: 4rem 0;
}

.value-prop-item {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  align-items: center;
}

/* Alternate image position for even items */
.value-prop-item:nth-child(even) {
  direction: rtl;
}

/* Reset text direction for content in even items */
.value-prop-item:nth-child(even) .value-prop-content {
  direction: ltr;
}

.value-prop-image {
  aspect-ratio: 1;
  overflow: hidden;
}

.value-prop-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.value-prop-content {
  text-align: left;
  padding: 2rem;
}

.value-prop-title {
  margin: 0 0 1rem;
  font-size: 1.5rem;
}

.value-prop-description {
  font-size: 1rem;
  line-height: 1.6;
  color: rgba(var(--color-foreground), 0.75);
}

/* Mobile styles */
@media screen and (max-width: 749px) {
  .value-prop-item {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .value-prop-item:nth-child(even) {
    direction: ltr;
  }
  
  .value-prop-content {
    padding: 1rem 0;
  }
}
</style>
